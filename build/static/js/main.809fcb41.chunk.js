(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{25:function(e,t,n){e.exports=n(53)},53:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),c=n.n(o),i=n(6),u=n(1),l=n.n(u),s=n(2),d=n(4),p=n(8),f=n.n(p),m=null,g={getAll:function(){var e=Object(s.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/api/blogs");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(s.a)(l.a.mark(function e(t){var n,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:m}},e.next=3,f.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){m="bearer ".concat(e)},update:function(){var e=Object(s.a)(l.a.mark(function e(t,n){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.put("".concat("/api/blogs","/").concat(n),t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(s.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.delete("".concat("/api/blogs","/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},b={login:function(){var e=Object(s.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},v=function(e){return function(){var t=Object(s.a)(l.a.mark(function t(n){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.create(e);case 2:a=t.sent,n({type:"ADD_BLOG",data:a});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"ADD_BLOG":return e.concat(t.data);case"DELETE_BLOG":return e.filter(function(e){return e.id!==t.data.id});case"ADD_LIKE":return e.map(function(e){return e.id!==t.data.id?e:t.data.blogToSave});default:return e}},E={addBlog:v,deleteBlog:function(e){return function(){var t=Object(s.a)(l.a.mark(function t(n){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.deleteBlog(e);case 2:n({type:"DELETE_BLOG",data:{id:e}});case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},like:function(e,t){return function(){var n=Object(s.a)(l.a.mark(function n(a){var r;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.update(e,t);case 2:r=n.sent,a({type:"ADD_LIKE",data:{blogToSave:r,id:t}});case 4:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},w=Object(i.b)(null,E)(function(e){var t=e.blog,n=Object(a.useState)(!1),o=Object(d.a)(n,2),c=o[0],i=o[1],u={display:c?"":"none"},p={display:c?"none":""},f={display:e.loggedUser===e.username?"":"none"},m=function(){i(!c)},g=function(){var n=Object(s.a)(l.a.mark(function n(a){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a.preventDefault();try{e.like({user:t.user.id,likes:++t.likes,author:t.author,title:t.title,url:t.url},t.id)}catch(r){console.log("likes update failed ",r)}case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),b=function(){var n=Object(s.a)(l.a.mark(function n(a){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a.preventDefault(),window.confirm("remove blog ".concat(t.title," by ").concat(t.author)))try{e.deleteBlog(t.id)}catch(r){console.log("remove blog failed")}case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}();return r.a.createElement("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5}},r.a.createElement("div",{className:"title",onClick:m,style:p},t.title," ",t.author),r.a.createElement("div",{style:u,className:"blogDetails"},r.a.createElement("div",{onClick:m},t.title," ",t.author),r.a.createElement("div",null,t.url),r.a.createElement("div",null,t.likes," likes ",r.a.createElement("button",{onClick:g},"like")),r.a.createElement("div",null,"added by ",e.username),r.a.createElement("button",{style:f,onClick:b},"remove")))}),y=function(e){var t=e.handleLogin,n=e.username,a=e.handleUsernameChange,o=e.password,c=e.handlePasswordChange;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Log in to application"),r.a.createElement("form",{onSubmit:t},r.a.createElement("div",null,"username: ",r.a.createElement("input",{value:n,onChange:a})),r.a.createElement("div",null,"password: ",r.a.createElement("input",{value:o,onChange:c})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"login"))))},O=r.a.forwardRef(function(e,t){var n=Object(a.useState)(!1),o=Object(d.a)(n,2),c=o[0],i=o[1],u={display:c?"none":""},l={display:c?"":"none"},s=function(){i(!c)};return Object(a.useImperativeHandle)(t,function(){return{toggleVisibility:s}}),r.a.createElement("div",null,r.a.createElement("div",{style:u},r.a.createElement("button",{onClick:s},e.buttonLabel)),r.a.createElement("div",{style:l},e.children,r.a.createElement("button",{onClick:s},"cancel")))}),j=function(e){return{type:"SHOW_ERROR",data:{message:e,notifType:"error"}}},k=function(){return{type:"HIDE",data:{message:"none",notifType:"none"}}},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{notifType:"",message:"welcome"},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_ERROR":case"SHOW_INFO":case"HIDE":return t.data;default:return e}},S={showError:j,showInfo:function(e){return{type:"SHOW_INFO",data:{message:e,notifType:"info"}}},hideNotification:k,addBlog:v},B=Object(i.b)(function(e){return{blogs:e.blogs}},S)(function(e){var t=Object(a.useState)(""),n=Object(d.a)(t,2),o=n[0],c=n[1],i=Object(a.useState)(""),u=Object(d.a)(i,2),p=u[0],f=u[1],m=Object(a.useState)(""),g=Object(d.a)(m,2),b=g[0],v=g[1],h=r.a.createRef(),E=function(){var t=Object(s.a)(l.a.mark(function t(n){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault();try{h.current.toggleVisibility(),e.addBlog({title:o,author:p,url:b}),e.showInfo("a new blog ".concat(o," ").concat(p," added")),setTimeout(function(){e.hideNotification()},5e3),c(""),f(""),v("")}catch(a){e.showError("error while adding a new blog"),console.log(a),setTimeout(function(){e.hideNotification()},5e3)}case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(O,{buttonLabel:"new blog",ref:h},r.a.createElement("h2",null,"create new"),r.a.createElement("form",{onSubmit:E},r.a.createElement("div",null,"title: ",r.a.createElement("input",{value:o,onChange:function(e){c(e.target.value)}})),r.a.createElement("div",null,"author: ",r.a.createElement("input",{value:p,onChange:function(e){f(e.target.value)}})),r.a.createElement("div",null,"url: ",r.a.createElement("input",{value:b,onChange:function(e){v(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("button",{type:"submit"},"create"))))}),T=function(e){var t=e.message,n=e.type;return"none"===t?null:"error"===n?r.a.createElement("div",{style:{color:"red",background:"lightgrey",fontSize:"20px",borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"10px"}},t):r.a.createElement("div",{style:{color:"blue",background:"lightgrey",fontSize:"20px",borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"10px"}},t)};var _={initializeBlogs:function(){return function(){var e=Object(s.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},showError:j,hideNotification:k},N=Object(i.b)(function(e){return{notificationMessage:e.notification.message,notificationType:e.notification.notifType,blogs:e.blogs}},_)(function(e){var t=Object(a.useState)(""),n=Object(d.a)(t,2),o=n[0],c=n[1],i=Object(a.useState)(""),u=Object(d.a)(i,2),p=u[0],f=u[1],m=Object(a.useState)(""),v=Object(d.a)(m,2),h=v[0],E=v[1];Object(a.useEffect)(function(){e.initializeBlogs()},[]),Object(a.useEffect)(function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);c(t)}},[]);var O=function(){var t=Object(s.a)(l.a.mark(function t(n){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,b.login({username:p,password:h});case 4:a=t.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(a)),g.setToken(a.token),c(a),f(""),E(""),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),e.showError("Wrong password or username"),setTimeout(function(){e.hideNotification()},5e3);case 16:case"end":return t.stop()}},t,null,[[1,12]])}));return function(e){return t.apply(this,arguments)}}();return""===o?r.a.createElement("div",{className:"App"},r.a.createElement(T,{message:e.notificationMessage,type:e.notificationType}),r.a.createElement("header",{className:"App-header"},r.a.createElement("h1",null,"Bloglist App")),r.a.createElement(y,{handleLogin:O,username:p,handleUsernameChange:function(e){f(e.target.value)},password:h,handlePasswordChange:function(e){E(e.target.value)}})):r.a.createElement("div",{className:"App"},r.a.createElement(T,{message:e.notificationMessage,type:e.notificationType}),r.a.createElement("header",{className:"App-header"},r.a.createElement("h1",null,"Bloglist App")),r.a.createElement("h2",null,"Blogs"),r.a.createElement("div",null,r.a.createElement("h3",null,o.name," is logged in")),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){c(""),window.localStorage.clear()}},"Logout")),r.a.createElement(B,null),e.blogs.sort(function(e,t){return Number(t.likes)-Number(e.likes)}).map(function(e){return r.a.createElement(w,{key:e.id,blog:e,username:e.user.username,loggedUser:o.username})}))}),D=n(7),L=n(24),I=Object(D.c)({blogs:h,notification:x}),C=Object(D.e)(I,Object(D.d)(Object(D.a)(L.a),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),A=function(){c.a.render(r.a.createElement(i.a,{store:C},r.a.createElement(N,null)),document.getElementById("root"))};A(),C.subscribe(A)}},[[25,1,2]]]);
//# sourceMappingURL=main.809fcb41.chunk.js.map