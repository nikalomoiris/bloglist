(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{58:function(e,t,a){e.exports=a(87)},87:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(24),o=a.n(c),l=a(9),u=a(19),i=a(7),s=a(12),d=a(20),p=a(57),f=a(5),m=a.n(f),g=a(6),b=a(22),E=a(8),v=a(21),h=a.n(v),y={login:function(){var e=Object(g.a)(m.a.mark(function e(t){var a;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},O=function(e){return{type:"SHOW_ERROR",data:{message:e,notifType:"error"}}},w=function(e){return{type:"SHOW_INFO",data:{message:e,notifType:"info"}}},j=function(){return{type:"HIDE",data:{message:"none",notifType:"none"}}},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{notifType:"",message:"welcome"},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_ERROR":case"SHOW_INFO":case"HIDE":return t.data;default:return e}},k=a(18),T=null,I={getAll:function(){var e=Object(g.a)(m.a.mark(function e(){var t;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get("/api/blogs");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(g.a)(m.a.mark(function e(t){var a,n;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:T}},e.next=3,h.a.post("/api/blogs",t,a);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){T="bearer ".concat(e)},update:function(){var e=Object(g.a)(m.a.mark(function e(t,a){var n;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.put("".concat("/api/blogs","/").concat(a),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(g.a)(m.a.mark(function e(t){var a;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.delete("".concat("/api/blogs","/").concat(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},S={getAll:function(){var e=Object(g.a)(m.a.mark(function e(){var t;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},L=function(e){return{type:"LOGIN",data:e}},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{user:"",allUsers:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IS_LOGGED_IN":var a=window.localStorage.getItem("loggedBlogappUser");if(a){var n=JSON.parse(a);return Object(k.a)(Object(k.a)({},e),{},{user:n})}return Object(k.a)(Object(k.a)({},e),{},{user:""});case"LOGIN":var r=t.data;return window.localStorage.setItem("loggedBlogappUser",JSON.stringify(r)),I.setToken(r.token),Object(k.a)(Object(k.a)({},e),{},{user:r});case"LOGOUT":return window.localStorage.clear(),Object(k.a)(Object(k.a)({},e),{},{user:""});case"GET_ALL_USERS":return Object(k.a)(Object(k.a)({},e),{},{allUsers:t.data.allUsers});default:return e}},_={showError:O,hideNotification:j,login:L},N=Object(i.f)(Object(l.b)(null,_)(function(e){var t=Object(n.useState)(""),a=Object(b.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(""),u=Object(b.a)(l,2),i=u[0],d=u[1],p=function(){var t=Object(g.a)(m.a.mark(function t(a){var n;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,y.login({username:c,password:i});case 4:n=t.sent,e.login(n),o(""),d(""),e.history.push("/blogs"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),e.showError("Wrong password or username"),setTimeout(function(){e.hideNotification()},5e3);case 15:case"end":return t.stop()}},t,null,[[1,11]])}));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Log in to application"),r.a.createElement(E.a,{onSubmit:p},r.a.createElement(E.a.Group,{controlId:"formUsername"},r.a.createElement(E.a.Label,null,"Username"),r.a.createElement(E.a.Control,{type:"text",value:c,onChange:function(e){o(e.target.value)},placeholder:"Enter username"})),r.a.createElement(E.a.Group,{controlId:"formBasicPassword"},r.a.createElement(E.a.Label,null,"Password"),r.a.createElement(E.a.Control,{type:"password",value:i,onChange:function(e){d(e.target.value)},placeholder:"Password"})),r.a.createElement(s.a,{variant:"primary",type:"submit"},"Login")))})),D=function(e){var t=e.message,a=e.type;return"none"===t?null:"error"===a?r.a.createElement("div",{style:{color:"red",background:"lightgrey",fontSize:"20px",borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"10px"}},t):r.a.createElement("div",{style:{color:"blue",background:"lightgrey",fontSize:"20px",borderStyle:"solid",borderRadius:"5px",padding:"10px",marginBottom:"10px"}},t)},G=a(28),U=r.a.forwardRef(function(e,t){var a=Object(n.useState)(!1),c=Object(b.a)(a,2),o=c[0],l=c[1],u={display:o?"none":""},i={display:o?"":"none"},d=function(){l(!o)};return Object(n.useImperativeHandle)(t,function(){return{toggleVisibility:d}}),r.a.createElement("div",null,r.a.createElement("div",{style:u},r.a.createElement(s.a,{variant:"success",onClick:d},e.buttonLabel)),r.a.createElement("div",{style:i},e.children,r.a.createElement(s.a,{style:{padding:5},variant:"secondary",onClick:d},"cancel")))}),A=function(e){return function(){var t=Object(g.a)(m.a.mark(function t(a){var n;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.create(e);case 2:n=t.sent,a({type:"ADD_BLOG",data:n});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"ADD_BLOG":return e.concat(t.data);case"DELETE_BLOG":return e.filter(function(e){return e.id!==t.data.id});case"ADD_LIKE":return e.map(function(e){return e.id!==t.data.id?e:t.data.blogToSave});default:return e}},R={showError:O,showInfo:w,hideNotification:j,addBlog:A},z=Object(l.b)(function(e){return{blogs:e.blogs}},R)(function(e){var t=Object(n.useState)(""),a=Object(b.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(""),u=Object(b.a)(l,2),i=u[0],d=u[1],p=Object(n.useState)(""),f=Object(b.a)(p,2),v=f[0],h=f[1],y=r.a.createRef(),O=function(){var t=Object(g.a)(m.a.mark(function t(a){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault();try{y.current.toggleVisibility(),e.addBlog({title:c,author:i,url:v}),e.showInfo("a new blog ".concat(c," ").concat(i," added")),setTimeout(function(){e.hideNotification()},5e3),o(""),d(""),h("")}catch(n){e.showError("error while adding a new blog"),console.log(n),setTimeout(function(){e.hideNotification()},5e3)}case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(U,{buttonLabel:"new blog",ref:y},r.a.createElement("h2",null,"create new"),r.a.createElement(E.a,{onSubmit:O},r.a.createElement(E.a.Group,{controlId:"formBlogTitle"},r.a.createElement(E.a.Label,null,"Blog title"),r.a.createElement(E.a.Control,{type:"text",value:c,onChange:function(e){o(e.target.value)},placeholder:"Enter blog title"})),r.a.createElement(E.a.Group,{controlId:"formBlogAthor"},r.a.createElement(E.a.Label,null,"Blog author"),r.a.createElement(E.a.Control,{type:"text",value:i,onChange:function(e){d(e.target.value)},placeholder:"Enter blog author"})),r.a.createElement(E.a.Group,{controlId:"formBlogUrl"},r.a.createElement(E.a.Label,null,"Blog url"),r.a.createElement(E.a.Control,{type:"text",value:v,onChange:function(e){h(e.target.value)},placeholder:"Enter blog url"})),r.a.createElement(s.a,{variant:"primary",type:"submit"},"Add")))}),H=Object(l.b)()(function(e){var t=e.blog;return r.a.createElement(u.b,{className:"title",to:"/blogs/".concat(t.id)},t.title," by ",t.author)}),F=Object(l.b)(function(e){return{blogs:e.blogs,user:e.users.user}})(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(z,null),r.a.createElement(G.a,null,e.blogs.sort(function(e,t){return Number(t.likes)-Number(e.likes)}).map(function(t){return r.a.createElement(G.a.Item,null,r.a.createElement(H,{key:t.id,blog:t,username:t.user.username,loggedUser:e.user.username}))})))}),W=a(55),J=Object(l.b)(function(e){return{users:e.users.allUsers}})(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{striped:!0,bordered:!0,hover:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"User"),r.a.createElement("th",null,"Blogs created"))),r.a.createElement("tbody",null,e.users.map(function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(u.b,{to:"/users/".concat(e.id)},e.name)),r.a.createElement("td",null,function(e){return e.blogs.length}(e)))}))))}),K=a(41),V=a(23),X=Object(l.b)()(function(e){if(void 0===e.user)return null;var t=e.user.blogs,a=e.user.name;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,a),r.a.createElement(K.a,null,r.a.createElement(V.a,null,r.a.createElement(V.a.Header,null,r.a.createElement(K.a.Toggle,{as:s.a,variant:"light",eventKey:"0"},"Added blogs")),r.a.createElement(K.a.Collapse,{eventKey:"0"},r.a.createElement(V.a.Body,null,r.a.createElement(G.a,{variant:"flush"},t.map(function(e){return r.a.createElement(G.a.Item,{key:e.id},e.title)})))))))}),P={addBlog:A,deleteBlog:function(e){return function(){var t=Object(g.a)(m.a.mark(function t(a){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.deleteBlog(e);case 2:a({type:"DELETE_BLOG",data:{id:e}});case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},like:function(e,t){return function(){var a=Object(g.a)(m.a.mark(function a(n){var r;return m.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,I.update(e,t);case 2:r=a.sent,n({type:"ADD_LIKE",data:{blogToSave:r,id:t}});case 4:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()}},M=Object(l.b)(function(e){return{user:e.users.user}},P)(function(e){var t=e.blog,a=t.user.username,n={display:e.user.username===a?"":"none"},c=function(){var a=Object(g.a)(m.a.mark(function a(n){return m.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:n.preventDefault();try{e.like({user:t.user.id,likes:++t.likes,author:t.author,title:t.title,url:t.url},t.id)}catch(r){console.log("likes update failed ",r)}case 2:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}(),o=function(){var a=Object(g.a)(m.a.mark(function a(n){return m.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n.preventDefault(),window.confirm("remove blog ".concat(t.title," by ").concat(t.author)))try{e.deleteBlog(t.id)}catch(r){console.log("remove blog failed")}case 2:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}();return r.a.createElement(V.a,{className:"blogDetails"},r.a.createElement(V.a.Body,null,r.a.createElement(V.a.Title,null,t.title," by ",t.author),r.a.createElement(V.a.Text,null,r.a.createElement("div",null,t.url),r.a.createElement("div",null,t.likes," likes",r.a.createElement(s.a,{variant:"success",size:"sm",onClick:c},"like")),r.a.createElement("div",null,"added by ",a)),r.a.createElement(s.a,{variant:"danger",size:"sm",style:n,onClick:o},"Delete")))});var q={initializeBlogs:function(){return function(){var e=Object(g.a)(m.a.mark(function e(t){var a;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getAll();case 2:a=e.sent,t({type:"INIT_BLOGS",data:a});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},showError:O,showInfo:w,hideNotification:j,isLoggedIn:function(){return{type:"IS_LOGGED_IN"}},login:L,logout:function(){return{type:"LOGOUT"}},getAllUsers:function(){return function(){var e=Object(g.a)(m.a.mark(function e(t){var a;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.getAll();case 2:a=e.sent,t({type:"GET_ALL_USERS",data:{allUsers:a}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}},Q=Object(l.b)(function(e){return{notificationMessage:e.notification.message,notificationType:e.notification.notifType,blogs:e.blogs,user:e.users.user,users:e.users.allUsers}},q)(function(e){var t={padding:5};Object(n.useEffect)(function(){e.showInfo("Welcome to the bloglist app"),setTimeout(function(){e.hideNotification()},5e3),e.initializeBlogs(),e.isLoggedIn()},[]),Object(n.useEffect)(function(){e.getAllUsers()},[e.blogs]);var a=function(t){return e.blogs.find(function(e){return e.id===t})};return r.a.createElement("div",{className:"App"},r.a.createElement(D,{message:e.notificationMessage,type:e.notificationType}),r.a.createElement(u.a,null,r.a.createElement("div",null,r.a.createElement(d.a,{bg:"light",expand:"lg",sticky:"top"},r.a.createElement(d.a.Brand,{to:"/blogs"},"Bloglist App"),r.a.createElement(d.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(d.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(p.a,{className:"mr-auto"},r.a.createElement(d.a.Text,null,r.a.createElement(u.c,{style:t,to:"/blogs"},"blogs")),r.a.createElement(d.a.Text,null,r.a.createElement(u.c,{style:t,to:"/users"},"users")))),r.a.createElement(d.a.Collapse,{className:"justify-content-end"},e.user?r.a.createElement(d.a.Text,null,e.user.name,r.a.createElement(s.a,{style:t,variant:"danger",size:"sm",onClick:function(){e.logout()}},"Logout")):r.a.createElement(d.a.Text,null,r.a.createElement(u.c,{style:t,to:"/login"},"login"),r.a.createElement(i.a,{to:"/login"})))),r.a.createElement(i.b,{exact:!0,path:"/login",render:function(){return r.a.createElement(N,null)}}),r.a.createElement(i.b,{exact:!0,path:"/blogs",render:function(){return r.a.createElement(F,null)}}),r.a.createElement(i.b,{exact:!0,path:"/users",render:function(){return r.a.createElement(J,null)}}),r.a.createElement(i.b,{exact:!0,path:"/users/:id",render:function(t){var a,n=t.match;return r.a.createElement(X,{user:(a=n.params.id,e.users.find(function(e){return e.id===a}))})}}),r.a.createElement(i.b,{exact:!0,path:"/blogs/:id",render:function(e){var t=e.match;return a(t.params.id)?r.a.createElement(M,{blog:a(t.params.id)}):r.a.createElement(i.a,{to:"/blogs"})}}))))}),Y=a(30),Z=a(56),$=Object(Y.b)({blogs:C,notification:x,users:B}),ee=Object(Y.d)($,Object(Y.c)(Object(Y.a)(Z.a),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),te=function(){o.a.render(r.a.createElement(l.a,{store:ee},r.a.createElement(Q,null)),document.getElementById("root"))};te(),ee.subscribe(te)}},[[58,1,2]]]);
//# sourceMappingURL=main.39e94ef8.chunk.js.map